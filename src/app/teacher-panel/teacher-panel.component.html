<div class="teacher-container">
  <h1 class="teacher-nombre">{{user?.nombre}}, {{user?.apellido}} <span class="teacher-dni">{{user?.dni}}</span></h1>
  <hr />

  <div class="teacher-grid">
    <div class="datos-box">
      <div class="card-header">
        <span class="titulo"> <strong>TUS DATOS</strong></span>
        <button class="edit-btn" title="Editar datos" *ngIf="!isEditing" (click)="editarDatos()">
          ✎
        </button>
      </div>
      <div *ngIf="!isEditing">
        <p><strong>Nombre y Apellido:</strong> {{ user?.nombre }} {{ user?.apellido }}</p>
        <p><strong>DNI:</strong> {{ user?.dni }}</p>
        <p><strong>Dirección:</strong> {{ user?.direccion }}</p>
        <p><strong>Email:</strong> {{ user?.email }}</p>
        <p><strong>Teléfono:</strong> {{ user?.telefono }}</p>
    </div>
    <form *ngIf="isEditing" (ngSubmit)="guardarDatos()">
        <p>
          <strong>Nombre:</strong>
          <input [(ngModel)]="user.nombre" name="nombre" required />
        </p>
        <p>
          <strong>Apellido:</strong>
          <input [(ngModel)]="user.apellido" name="apellido" required />
        </p>
        <p>
          <strong>Dirección:</strong>
          <input [(ngModel)]="user.direccion" name="direccion" />
        </p>
        <p>
          <strong>Correo:</strong>
          <input [(ngModel)]="user.email" name="email" type="email" required />
        </p>
        <p>
          <strong>Teléfono:</strong>
          <input [(ngModel)]="user.telefono" name="telefono" type="tel" />
        </p>
        <!-- Contraseña -->
        <p>
          <strong>Contraseña:</strong>
          <input [(ngModel)]="user.contrasena" name="contrasena" type="password" required />
        </p>
        <button type="submit" class="save-btn">Guardar</button>
        <button type="button" class="cancel-btn" (click)="cancelarEdicion()">Cancelar</button>
      </form>
      </div>
    <div class="estado-box">
      <div class="clases-box">
        <h4>Mis cursos</h4>
          <ng-container *ngIf="cursos.length > 0; else sinCursos">
            <ul>
              <li *ngFor="let curso of cursos">
                {{ curso.nom_curso }} <span *ngIf="curso.num_aula"> - Aula: {{ curso.num_aula }}</span>
                <button class="edit-btn" title="Editar curso" (click)="editarCurso(curso)">✎</button>
              </li> 
            </ul>
          </ng-container>
          <ng-template #sinCursos>
            <p>No estás asignado a ningún curso.</p>
          </ng-template>
          <button class="curso-btn" routerLink="/course-form">Nuevo Curso</button>
      </div>

      <div class="horarios-box">
        <div class="horarios-header">
          <h4>Proximas clases</h4>
        </div>
          <ng-container *ngFor="let curso of cursos">
            <ng-container *ngIf="curso.talleres && curso.talleres.length > 0;">
              <ul>
                  <li *ngFor="let taller of curso.talleres">
                    {{ taller.nom_taller }}
                    <span *ngIf="taller.fecha"> - Fecha: {{ taller.fecha | date:'dd/MM/yyyy' }}</span>
                    <span *ngIf="taller.hora_ini"> - Horario: {{ taller.hora_ini }}</span>
                    <button class="edit-btn" title="Editar taller" (click)="editarTaller(taller)">✎</button>
                  </li>  
              </ul>
            </ng-container>
          </ng-container>
        <button class="historial-btn">Historial</button>
      </div>
    </div>
  </div>
  <!---Visibilziar este contenedor cuando se de click a un edit-btn de la seccion de cursos-->
  <div *ngIf="isEditingCurso" class="edicionCurso">
      <form action="" (ngSubmit)="guardarCursoModificado()">
          <p>
              <strong>Nombre del curso:</strong>
              <input [(ngModel)]="cursoSeleccionado.nom_curso" name="nombreCurso" required />
          </p>
          <p>
              <strong>Aula:</strong>
              <input [(ngModel)]="cursoSeleccionado.num_aula" name="aulaCurso" required/>
          </p>
          <p>
              <strong>Descripción:</strong>
              <textarea [(ngModel)]="cursoSeleccionado.descripcion" name="descripcionCurso" required></textarea>
          </p>
          <p>
            <strong>Fecha de inicio:</strong>
            <input [(ngModel)]="cursoSeleccionado.fec_inicio" name="fechaInicio" type="date" required />
          </p>
          <p>
            <strong>Fecha Fin:</strong>
            <input [(ngModel)]="cursoSeleccionado.fec_fin" name="fechaFin" type="date" required />
          </p>
          <button type="submit" class="save-btn">Guardar</button>
          <button type="button" class="cancel-btn" (click)="cancelarEdicionCurso()">Cancelar</button>
      </form>
  </div>

  <div *ngIf="isEditingTaller" class="edicionTaller">
      <form action="" (ngSubmit)="guardarTallerModificado()">
          <p>
              <strong>Nombre del taller:</strong>
              <input [(ngModel)]="tallerSeleccionado.nom_taller" name="nombreTaller" required />
          </p>
          <p>
              <strong>Fecha:</strong>
              <input [(ngModel)]="tallerSeleccionado.fecha" name="fechaTaller" type="date" required />
          </p>
          <p>
              <strong>Hora de inicio:</strong>
              <input [(ngModel)]="tallerSeleccionado.hora_ini" name="horaInicioTaller" type="time" required />
          </p>
          <p>
            <strong>Tematica:</strong>
            <input [(ngModel)]="tallerSeleccionado.tematica" name="tematicaTaller" required />
          </p>
          <p>
            <strong>Requisitos:</strong>
            <textarea [(ngModel)]="tallerSeleccionado.requisitos" name="requisitosTaller" required></textarea>
          </p>
          <button type="submit" class="save-btn">Guardar</button>
          <button type="button" class="cancel-btn" (click)="cancelarEdicionTaller()">Cancelar</button>
      </form>
  </div>

</div>